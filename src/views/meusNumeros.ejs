<%- include('includes/head'); %>
<%- include('includes/nav'); %>

<!-- Modal de envio de jogos -->
<div id="modal-enviar-jogos" class="modal-overlay" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Enviar Meus Jogos</h2>
            <button class="modal-close" onclick="fecharModal()">&times;</button>
        </div>
        <div class="modal-body">
            <p>Digite o nome do usuÃ¡rio para o qual deseja enviar seus jogos:</p>
            <input type="text" id="nome-usuario-envio" placeholder="Nome do usuÃ¡rio" class="modal-input">
        </div>
        <div class="modal-footer">
            <button class="btn-cancelar" onclick="fecharModal()">Cancelar</button>
            <button class="btn-confirmar" onclick="enviarJogos()">Enviar</button>
        </div>
    </div>
</div>

<main class="meus-jogos-container">
    <div class="meus-jogos-header">
        <div class="verifica-numeos">
            <input type="text" id="verifica-numeros-input" placeholder="Ex: 05,12,23,34,45,56" aria-label="Verificar nÃºmeros">
            <button class="btn-verificar" title="Verificar NÃºmeros">
                ğŸ” Verificar
            </button>
        </div>

        <div class="header-content">
            <h1>Meus NÃºmeros</h1>
            <% if (user) { %>
                <p class="user-info">Bem-vindo, <strong><%= user.username %></strong></p>
            <% } %>
        </div>

        <button class="btn-enviar-jogos" title="Enviar meus jogos" onclick="abrirModal()">
            ğŸ“¤ Enviar Meus Jogos
        </button>
    </div>

    <% if (jogos.length === 0) { %>
        <div class="empty-state">
            <div class="empty-icon">ğŸ²</div>
            <h2>Nenhuma sequÃªncia salva ainda</h2>
            <p>VocÃª ainda nÃ£o salvou nenhuma sequÃªncia de nÃºmeros.</p>
            <a href="/" class="btn-criar-novo">Criar uma SequÃªncia</a>
        </div>
    <% } else { %>
        <div class="jogos-stats">
            <div class="stat-card">
                <span class="stat-label">Total de SequÃªncias</span>
                <span class="stat-value"><%= jogos.length %></span>
            </div>
            <div class="stat-card">
                <span class="stat-label">Valor Total das Apostas</span>
                <span class="stat-value">R$ <%= (jogos.length * 6).toFixed(2).replace('.', ',') %></span>
            </div>
        </div>

        <div class="jogos-grid">
            <% jogos.forEach((jogo, index) => { %>
                <div class="jogo-card" data-jogo-id="<%= jogo._id %>">
                    <div class="jogo-header">
                        <span class="jogo-numero">#<%= index + 1 %></span>
                        <span class="jogo-data">
                            <% 
                            const data = new Date(jogo.criadoEm);
                            const dia = String(data.getDate()).padStart(2, '0');
                            const mes = String(data.getMonth() + 1).padStart(2, '0');
                            const ano = data.getFullYear();
                            const horas = String(data.getHours()).padStart(2, '0');
                            const minutos = String(data.getMinutes()).padStart(2, '0');
                            %>
                            <%= dia %>/<%= mes %>/<%= ano %> Ã s <%= horas %>:<%= minutos %>
                        </span>
                    </div>
                    
                    <div class="jogo-preco">
                        <span class="preco-label">ğŸ’°</span>
                        <span class="preco-valor">R$ 6,00</span>
                    </div>
                    
                    <div class="jogo-numeros">
                        <% jogo.numeros.forEach(numero => { %>
                            <span class="numero-badge"><%= numero %></span>
                        <% }); %>
                    </div>
                    
                    <div class="jogo-actions">
                        <button class="btn-copiar" onclick="copiarNumeros('<%= jogo.numeros.join(', ') %>')" title="Copiar nÃºmeros">
                            ğŸ“‹ Copiar
                        </button>
                        <button class="btn-deletar" onclick="deletarJogo('<%= jogo._id %>')" title="Deletar sequÃªncia">
                            ğŸ—‘ï¸ Deletar
                        </button>
                    </div>
                </div>
            <% }); %>
        </div>

        <div class="jogos-footer">
            <button class="btn-deletar-todos" onclick="deletarTodas()" title="Deletar todas as sequÃªncias">
                ğŸ—‘ï¸ Deletar Todas as SequÃªncias
            </button>
        </div>
    <% } %>
    <div class="volta-home">
        <a href="/" class="btn-voltar">â† Voltar Ã  PÃ¡gina Principal</a>
    </div>
</main>

<script src="/assets/js/meusNumeros.js"></script>

<%- include('includes/footer'); %>